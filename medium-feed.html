<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Latest on Medium</title>
  <style>
    :root{ --fg:#111; --muted:#6b7280; --border:#e5e7eb; --card:#fff; --link:#2563eb; }
    html,body{height:100%}
    body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;background:transparent;color:var(--fg)}
    .wrap{max-width:1100px;margin:0 auto;padding:2rem 1rem}
    h2{margin:0 0 1rem;font:600 1.6rem/1.3 system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;color:var(--fg)}
    .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:18px}
    article{border:1px solid var(--border);border-radius:16px;overflow:hidden;background:var(--card);
            display:flex;flex-direction:column;box-shadow:0 1px 2px rgba(0,0,0,.04)}
    .img{display:block;aspect-ratio:16/9;background:#f6f7f9;overflow:hidden}
    .img img{width:100%;height:100%;object-fit:cover;display:block}
    .meta{font-size:.9rem;color:var(--muted)}
    h3{margin:0;font:600 1.05rem/1.3 system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;color:var(--fg)}
    .link{font-size:.9rem;color:var(--link);text-decoration:none}
    a{text-decoration:none;color:inherit}
    .card{padding:16px;display:flex;flex-direction:column;gap:8px}
    #err{color:#b91c1c}
  </style>
</head>
<body>
  <div class="wrap">
    <h2>Latest on Medium</h2>
    <div id="grid" class="grid"></div>
    <p id="err" style="display:none">Couldn't load Medium posts.</p>
  </div>

  <script>
  (async () => {
    const HANDLE = 'brianiselin67';
    const RSS_URL = `https://api.rss2json.com/v1/api.json?rss_url=https://medium.com/feed/@${HANDLE}`;

    const grid = document.getElementById('grid');
    const err = document.getElementById('err');

    function fmtDate(d){
      try { return new Date(d).toLocaleDateString(undefined,{year:'numeric',month:'short',day:'numeric'}); }
      catch { return ''; }
    }

    function extractReadTime(description){
      const match = description.match(/(\d+)\s*min\s*read/i);
      return match ? `${match[1]} min read` : '';
    }

    function extractImage(description){
      const imgMatch = description.match(/<img[^>]+src="([^"]+)"/i);
      return imgMatch ? imgMatch[1] : null;
    }

    function card(item){
      const img = item.thumbnail || extractImage(item.description || '');
      const readTime = extractReadTime(item.description || '');
      
      return `
        <article>
          ${img ? `<a class="img" href="${item.link}" target="_blank" rel="noopener"><img src="${img}" alt=""></a>` : ''}
          <div class="card">
            <a href="${item.link}" target="_blank" rel="noopener"><h3>${item.title}</h3></a>
            <div class="meta">${[fmtDate(item.pubDate), readTime, item.author].filter(Boolean).join(' • ')}</div>
            <a class="link" href="${item.link}" target="_blank" rel="noopener">Read on Medium →</a>
          </div>
        </article>`;
    }

    try {
      const response = await fetch(RSS_URL);
      const data = await response.json();
      
      if (data.status !== 'ok') {
        throw new Error('RSS feed error: ' + (data.message || 'Unknown error'));
      }

      const items = data.items || [];
      
      if (items.length === 0) {
        err.textContent = 'No posts found.';
        err.style.display = 'block';
      } else {
        grid.innerHTML = items.map(card).join('');
        err.style.display = 'none';
      }
    } catch(e){
      console.error('Error loading Medium posts:', e);
      err.style.display = 'block';
    }
  })();
  </script>
</body>
</html>
